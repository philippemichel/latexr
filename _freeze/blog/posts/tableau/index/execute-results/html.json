{
  "hash": "42f9fe4e73e2fb43b52edd23a464cda2",
  "result": {
    "markdown": "---\ntitle: \"Organiser son tableau de données\"\ndescription: \"Comment ne pas faire trop de bêtises avec Excel®\"\nauthor: \"Philippe MICHEL\"\ncategories:\n  - R\n  - Organisation du travail\n---\n\n\nUn tableur comme Excel® est un outil de comptabilité analytique & n’a jamais été conçu pour stocker des données. Néanmoins ces logiciels sont puissants, versatiles, très pratiques, semblent simples d’emploi & permettent, sous certaines conditions, de stocker des tableaux simples. Un peu de réflexion & de travail préparatoire vous feront gagner beaucoup de temps.\n\n# Un seul tableau\n\nVos résultats doivent rentrer dans un seul tableau. Dans certains\ncas c’est impossible. Dans ce cas c’est un tableau par onglet (avec un\nnom clair pour l’onglet). \n\nPar exemple, un travail sur la prise en charge d’une pathologie dans les services d’un hôpital. Vous n’allez pas ressaisir les caractéristiques du service pour chaque patient. Vous aurez donc un tableau Patients avec une variable `Service` qui permettra de\nrattacher ce patient aux données du service contenus dans un autre\ntableau nommé `Service`.\n\n# Un tableau c’est un rectangle plein\n\nPar convention les cas (patients par ex.) sont en ligne & les variables (âge, poids...) en colonne donc un grand rectangle.\n\nCe tableau ne contient que les données, aucun calcul. Pas de moyenne\nen bas de colonnes. Si vous voulez faire des calculs, résumés etc. copiez l’onglet & faites tout ce que vous voulez sur la copie.\n\n|id|age|sexe|poids|taille|imc|\n|:--:|:--:|:--:|:--:|:--:|:--:| \n|1|45|F|65|165|24|\n|2|65|M|80|NA|26|\n|3|35|F|55|160|21|\n\n\n# Données manquantes\n\nMalheureusement vous aurez des données manquantes. La case\nne doit pas être vide pour autant. Il faut noter un code arbitraire pour\ncoder ces données. Habituellement on utilise **NA** pour *Not Available*\nmais l’important est de toujours utiliser le même code.\n\n# des Variables\n\n## Nom des variables\n\nLe nom de la variable va être utilisé pour écrire le code. Par exemple pour calculer la moyenne de l’âge (variable `age` du tableau `patients`):\n\n```r\nmean(patients$age)\n```\n\nIl donc évident qu’il doit s’agir d’un nom simple & court, pas la\nquestion posé au patient sur le questionnaire. Ce nom ne doit pas\ncomporter d’accent, d’espace ou de caractère bizarre (#$£~-). \n\nPlusieurs normes existent, je vous conseille de suivre la norme **Petit serpent** :\n\n|Norme|Exemple|\n|:--:|:--:|\n|Grand chameau|AgePatient|\n|Petit chameau|agePatient|\n|Petit serpent|age_patient|\n|Grand serpent|Age_patient|\n\n\n# Titres des variables\n\nChaque variable (donc chaque colonne) doit avoir un titre & un\nseul. Donc UNE & une seule ligne de titre. \n\n## Tableau inutilisable\n\n![](tab1.png){fig-align=\"center\"}\n\nCe tableau, bien que parfaitement clair pour un être humain, est\ninutilisable. Quel est le nom de la variable en colonne 2 ?\n\n## Première solution – format court\n\n![](tab2.png){fig-align=\"center\"}\n\nSolution simple. La comparaison des PA entre H1 & H2 (test de\nstudent) va s’écrire (en simplifiant):\n\n```r\nt.test(PA_H1,PA_H2, data = patients)\n```\n\n## Deuxième solution – format long\nExactement les mêmes données, seule la présentation change :\n\n![](tab3.png){fig-align=\"center\"}\n\nLa comparaison des PA entre H1 & H2 (test de student) va zalors s’écrire :\n\n```r\nt.test(PA~heure, data = patients)\n```\n\nLes deux formats sont acceptables. Le format long est souvent plus facile à utiliser mais la conversion d’un format à l’autre est très facile  (voir les fonctions `pivot_longueur` ou `pivot_wider` de la librairie `tidyverse`).\n\n## Du codage des variables\n\nBeaucoup de personnes, souvent beaucoup plus jeunes que moi, sont persuadées qu’un ordinateur ne peut gérer que des chiffres.\nGrande nouvelle, c’est faux ! Et votre tableau sera plus clair avec des intulés en clair (Homme, Femme) qu’avec des chiffres (1, 0). Même les\nscores ou échelles doivent être notés en texte. Les coder en numérique\nrevient à dire que passer de 1 à 2 est ausi grave que de passer de 6 à 7.\nVous en être sûr ? Pensez à un score de Glasgow par ex. Bien entendu il y aura des cas où on sera plus à l'aise avec des données pseudo numériques. Il sera alors facile d'effectuer la conversion. \n\nIl reste à éviter les erreurs de saisie. On voit souvent dans la même\ncolonne des |oui| , |Oui| , |OUI| & surtout | oui| avec une espace avant ou après . On\npeut facilement éviter ça & gagner du temps sur la saisie en utilisant\nl’outil *Validation de données* dans Excel®. Ça vous évitera aussi des\nâges de 548 ans & la saisie sera beaucoup plus rapide.\n\n## Des nombres\n\nUne variable numérique ne doit contenir que des nombres ! Et\n> 5 ou 5 mmol/L ne sont pas des nombres ! L’unité de mesure n’a pas à\nêtre présente sur le tableau final, ni dans le titre, ni dans les données.\nUtilisez la validation de données aussi pour vos variables numériques.\nC’est un peu de travail au début mais un gain de temps & de sécurité\nensuite.\n\n## Date & Heure\n\nLes dates & heures sont une source d’erreur constante. Il exite au\nmoins trois manière d’écrire les dates d’usage courant. La\nsolution est de ne pas laisser Excel® choisir & d’entrer les dates en\nformat texte ou de faire très attention au codage. En particulier deux\ncolonnes peuvent être codées différement sans que vous l’ayez demandé. De toute façon il faudra convertir les dates pour le logiciel de\nstatistique donc choisissez une norme, n’importe laquelle, mais n’en\nchangez pas en route.\n\nDe plus certains systèmes compte le temps en seconde depuis le\n01/01/1900, d’autres depuis le 01/01/1904... Sans parler des différents codages selon les pays : \n\n\n::: {.cell tbl-name='dates'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Norme </th>\n   <th style=\"text-align:left;\"> date </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> France </td>\n   <td style=\"text-align:left;\"> 12/08/2023 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> France </td>\n   <td style=\"text-align:left;\"> 12 Août 2023 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> USA </td>\n   <td style=\"text-align:left;\"> 08-12-2023 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ISO 8601 </td>\n   <td style=\"text-align:left;\"> 2023-08-12 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## Comment préparer son tableau\nVous comprenez bien qu’on improvise pas un tableau de données. La bonne solution, un peu lourde mais si pratique est d’écrire\nun tableau de ses variables (*CodeBook*) avec toutes les\ninformations :\n\n\n::: {.cell tbl-name='Codebook' hash='index_cache/html/codebook_2d4c52021c8d8c9650acbe4c5c7700fd'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> variable </th>\n   <th style=\"text-align:left;\"> description </th>\n   <th style=\"text-align:left;\"> unite </th>\n   <th style=\"text-align:left;\"> limite </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> date_adm </td>\n   <td style=\"text-align:left;\"> Date d'admission </td>\n   <td style=\"text-align:left;\"> DD/MM/YY </td>\n   <td style=\"text-align:left;\"> 01/01/2022 - 31/12/2024 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:left;\"> Âge </td>\n   <td style=\"text-align:left;\"> années </td>\n   <td style=\"text-align:left;\"> 18 - 110 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sexe </td>\n   <td style=\"text-align:left;\"> Sexe </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> F ou M </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> spo2 </td>\n   <td style=\"text-align:left;\"> SpO2 à l'admission </td>\n   <td style=\"text-align:left;\"> % </td>\n   <td style=\"text-align:left;\"> 50 - 100 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n# des Sauvegardes !\n\nUn ordinateur n’est qu’une machine & est sujet à la panne. Un\ndisque dur est une mécanique fragile (qu’il soit mécanique ou SSD).\nUne tasse de café peut se renverser. Donc on fait des sauvegardes !\nSur plusieurs supports en local & à distance. Il existe des solutions\nsimples de sauvegarde (TimeMachinel® sur MacOS® ou rsync sur\nLinux par ex.).\n\n::: {.callout-warning}\n## Un fichier non sauvegardé n’existe pas !\n:::\n\n# Remerciements\n\nUne grande partie de ces conseils est très bien expliquée sur le\n[blog de Claire Della-Vedova](https://delladata.fr/) dont je me suis largement inspiré.\n\n:::{.callout-tip}\n## Pour me joindre\n\nUn simple mail à <a href=\"mailto:docphilmstat@gmail.com\">docphilmstat@gmail.com</a> ou un message sur [Twitter](https://twitter.com/PhiippeMICHEL) & je vous répondrai dans les plus brefs délais.\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}